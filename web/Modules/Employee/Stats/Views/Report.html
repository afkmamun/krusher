<div class="row" >
    <div class="col-md-12" >
        <div class="card card-info card-outline">
            <highchart  config="chartConfig" ></highchart>
        </div>
     </div>
</div>

 <section class="content">
      <div class="row">
        <div class="col-md-2 no-padding">
          <!--TAGS-->
          <div class="card card-info card-outline">
            <div class="card-header with-border">
                     <h3 class="card-title"><i class="fas fa-edit"></i>  {{'filters' | translate}}</h3>
              <div class="card-tools">
 
              </div>
            </div>
            <div class="card-body p-1">
                    <div>
                        <b>{{'dateFrom'| translate}}</b><br>
                        <div class="input-group md-3">
                            <input ng-model="model.DateFrom" class="form-control" ng-model-options="{ updateOn: 'blur' }" style="border-top-left-radius: 3px;border-bottom-left-radius: 3px;">
                            <div class="input-group-append">
                                        <button moment-picker="model.DateFrom" max-date="model.DateTo" format="YYYY-MM-DD" class="btn btn-default">
                                            <i class="fa fa-calendar" aria-hidden="true"></i>
                                        </button>
                            </div>
                        </div>            
                    </div>
                    <br>
                    <div>
                        <b>{{'dateTo'| translate}}</b><br>
                        <div class="input-group md-3">
                            <input ng-model="model.DateTo" class="form-control" ng-model-options="{ updateOn: 'blur' }" style="border-top-left-radius: 3px;border-bottom-left-radius: 3px;">
                            <div class="input-group-append">
                                        <button moment-picker="model.DateTo" min-date="model.DateFrom" format="YYYY-MM-DD" class="btn btn-default">
                                            <i class="fa fa-calendar" aria-hidden="true"></i>
                                        </button>
                            </div>
                        </div> 
                    </div>
                    <br>

                    <!-- <label >{{'dateFrom' | translate}}</label>
                    <form name="myform3">
                        <p class="input-group custom-datepicker-buttons">
                        <input      type            ="text"
                                    name            ="data"
                                    class           ="editor form-control"
                                    ng-class        =" {'alert-danger':myform3.data.$error.pattern} "
                                    ng-pattern      ='/^(\d{4})\-(0?[1-9]|1[012])\-(0?[1-9]|[12][0-9]|3[01])$/'
                                    ng-model        ="model.DateFrom"
                                    ng-maxlength    ="10"
                                    ng-minxlength   ="10"
                                    ng-required     ="true"
                                    uib-tooltip     ="{{'example' | translate}}: 1987-01-01 , {{'dateFormat' | translate}}: гггг.мм.дд"
                                    tooltip-trigger ="focus"
                                    tooltip-placement="top"
                                    placeholder     ="{{'example' | translate}}: 1987-01-01"
                                    uib-datepicker-popup="{{format}}" is-open="datepicker.opened" datepicker-options="dateOptions" my-date
                                    ng-enter="Save(model)"
                                />
                            <span class="input-group-append">
                                <button class="btn btn-default" ng-click="datepicker.opened=true;">
                                    <i class="fa fa-calendar"></i>
                                </button>
                            </span>
                        </p>
                    </form>
                    <span  ng-show="myform3.data.$error.pattern">{{'wrongFormat' | translate}}!</span>

                    <br/>
                    <label >{{'dateTo' | translate}}</label>
                    <form name="myform2" ng-init="datepicker2.opened=false;">
                        <p class="input-group custom-datepicker-buttons">
                        <input      type            ="text"
                                    name            ="data"
                                    class           ="editor form-control"
                                    ng-class        ="{'alert-danger':myform2.data.$error.pattern} "
                                    ng-pattern      ='/^(\d{4})\-(0?[1-9]|1[012])\-(0?[1-9]|[12][0-9]|3[01])$/'
                                    ng-model        ="model.DateTo"
                                    ng-maxlength    ="10"
                                    ng-minxlength   ="10"
                                    ng-required     ="true"
                                    uib-tooltip     ="{{'example' | translate}}: 1987-01-30 , {{'dateFormat' | translate}}: гггг.мм.дд"
                                    tooltip-trigger ="focus"
                                    tooltip-placement="top"
                                    placeholder     ="{{'example' | translate}}: 1987-01-30"
                                    uib-datepicker-popup="{{format}}" is-open="datepicker2.opened" datepicker-options="dateOptions" my-date
                                    ng-enter="Save(model)"
                                />
                            <span class="input-group-append">
                                <button class="btn btn-default" ng-click="datepicker2.opened=true;">
                                    <i class="fa fa-calendar"></i>
                                </button>
                            </span>
                        </p>
                    </form>
                    <span  ng-show="myform2.data.$error.pattern">{{'wrongFormat' | translate}}!</span>
                    <br/> -->

                    <label >{{'step' | translate}}</label>
                    <ui-select ng-model="model.Step" theme="bootstrap4-1" class="normal bg-custom-white" size="100%" on-select="Save(model)">
                        <ui-select-match  placeholder="{{'select' | translate}}">{{$select.selected.Name | translate}}</ui-select-match>
                        <ui-select-choices repeat="c.ID as c in shag | filter: $select.search">
                            {{c.Name | translate}}
                        </ui-select-choices>
                    </ui-select>
                    <br/>
                    <div>
                        <label>{{'responsible'| translate}}</label>
                        <ng-dropdown-multiselect  options="em" ng-if="Auth.roleID!=2" selected-model="model.emIDs" theme="bootstrap4-1" class="normal bg-custom-white" disabled="!can('EM','edit')"
                            extra-settings="{ template: '<b> {{option.emName}} </b> <small ng-if=\'option.sipName\'> SIP/{{option.sipName}} </small>', scrollableHeight: '350px', scrollable: true, buttonClasses : 'btn btn-white', searchField: 'emName', enableSearch: true, keyboardControls: true, styleActive : true, idProperty: 'emID',externalIdProp: 'emID'}"
                            translation-texts="texts">
                        </ng-dropdown-multiselect>
                        <ng-dropdown-multiselect  options="employees.group[Auth.emID]" ng-if="Auth.roleID==2" selected-model="model.emIDs" theme="bootstrap4-1" class="normal bg-custom-white" disabled="!can('EM','edit')"
                            extra-settings="{ template: '<b> {{option.emName}} </b> <small ng-if=\'option.sipName\'> SIP/{{option.sipName}} </small>', scrollableHeight: '350px', scrollable: true, buttonClasses : 'btn btn-white', searchField: 'emName', enableSearch: true, keyboardControls: true, styleActive : true, idProperty: 'emID',externalIdProp: 'emID'}"
                            translation-texts="texts">
                        </ng-dropdown-multiselect>
                    <br/><br/>
                    </div>                    

                    <label >{{'docType' | translate}}</label>
                    <div class="input-group">
                        <ui-select ng-model="model.dctID" theme="bootstrap4-1" class="normal bg-custom-white">
                                    <ui-select-match  placeholder="{{'select' | translate}}">{{$select.selected.dctName | translate}}</ui-select-match>
                                    <ui-select-choices repeat="c.dctID as c in docsTypes.data | filter: $select.search">
                                        {{c.dctName | translate}}
                                    </ui-select-choices>
                        </ui-select>
                        <span class="input-group-append">
                                    <button ng-show="model.dctID" class="btn btn-default" ng-click="model.dctID = null"><i class="fa fa-times" aria-hidden="true"></i></button>
                        </span>
                    </div> 
                    <br/>
                    <div ng-if="model.dctID === 1">
                        <label >{{'status' | translate}}</label>
                        <div class="input-group" style="width: 100%">
                            <ui-select ng-model="model.disposition" theme="bootstrap4-1" class="normal bg-custom-white" size="100%">
                                        <ui-select-match  placeholder="{{'select' | translate}}">{{($select.selected.Name | CallStatus).disposition}}</ui-select-match>
                                        <ui-select-choices repeat="c.tvID as c in Enums.group[7] | filter: $select.search">
                                            <!-- {{c.Name | translate}} -->
                                            {{(c.Name | CallStatus).disposition }}
                                        </ui-select-choices>
                            </ui-select>
                            <span class="input-group-append">
                                        <button ng-show="model.disposition" class="btn btn-default" ng-click="model.disposition = null"><i class="fa fa-times" aria-hidden="true"></i></button>
                            </span>
                        </div> 
                        <br/>
                    </div>

                    <b>{{'callType'| translate}}</b><br/>
                        <div class="btn-group">
                          <button class="btn btn-default" ng-class="{'active' :  model.IsOut===null}" ng-click="model.IsOut=null">{{'All'| translate}}</button>
                          <button class="btn btn-default" ng-class="{'active' :  model.IsOut===true}" ng-click="model.IsOut=true" uib-tooltip="{{true | CallTypeFilters}}"><i class="fa fa-arrow-circle-up fa-lg" style="color:grey;" ></i></button>
                          <button class="btn btn-default" ng-class="{'active' :  model.IsOut===false}" ng-click="model.IsOut=false" uib-tooltip="{{false | CallTypeFilters}}"><i class="fa fa-arrow-circle-down fa-lg" style="color:black;" ></i> </button>
                        </div>
                    <br/>
                    <br/>
                    <div class="btn-group float-right" >

                        <!-- <div ng-show="global.Loading" class="btn btn-warning">
                                    <i class="fa fa-spinner fa-pulse fa-fw"></i> {{'Loading' | translate}}
                        </div> -->
                        <button ng-disabled="global.Loading" ng-show="model.Step && model.DateFrom && model.DateTo" class="btn"  ng-class="{'btn-warning' : global.Loading , 'btn-success' : !global.Loading}" ng-click="Save(model)">
                                <i ng-show="global.Loading" class="fa fa-spinner fa-pulse fa-fw"></i> 
                                <span ng-show="global.Loading" translate="Loading"></span>
                                <span ng-hide="global.Loading" translate="toForm"></span>
                        </button> <!-- && !Loading -->

                        <button class="btn btn-primary dropdown-toggle" data-toggle="dropdown">
                                <i class="fa fa-wrench"></i>
                        </button>

                        <div class="dropdown-menu dropdown-menu-right" role="menu">
                                <a class="dropdown-item" ng-show="data.length != []" ng-click="manyAction.download(model);" href><span><i class="fas fa-file-excel"></i> {{'export' | translate}}</span></a> 
                                <a class="dropdown-item" href ng-hide="global.Loading" ng-click="ClearFilter()" >
                                       <span><i class="fa fa-undo"></i> {{'Clear_filter'| translate}}</span>
                                </a>
                                
                        </div>
                    </div>    
            </div>
          </div>
        </div>

         <!--DATA RIGHT-->
        <div class="col-md-10">
          <div class="card card-info card-outline">
             <div class="card-body  p-0">
                <div class="table table-head-fixed-responsive mailbox-messages"  style="border-right: 1px solid #e7e7e7; overflow-y: auto; height:74vh; " can-load="canLoad" infinite-scroll="manyAction.loadMore()"  threshold="100">
                    <div class="row">
                        <div class="col-md-12">
                            <!-- <pre>{{model|json}}</pre> -->
                            <ng-include src="'/Views/LoadingTable.html'"></ng-include>
                                <table class="table table-head-fixed table-hover dataTable" ng-hide="global.Loading">
                                            <th width="10%">
                                                <b ng-show="Step === 1">{{'hour' | translate}} </b>
                                                <b ng-show="Step === 2">{{'day' | translate}}  </b>
                                                <b ng-show="Step === 3">{{'week' | translate}} </b>
                                                <b ng-show="Step === 4">{{'month' | translate}}</b>
                                                <b ng-show="Step === 5">{{'year' | translate}} </b>
                                            </th>
                                            <th width="20%"> {{'employee' | translate}}</th>
                                            <th width="20%"> {{'status' | translate}}</th>
                                            <th width="10%"> {{'numberCalls' | translate}}</th>
                                            <th width="10%"> {{'ADT' | translate}}</th>
                                            <th width="10%"> {{'ABT' | translate}}</th>
                                            <th width="10%"> {{'AWT' | translate}}</th>
                                            <th width="10%"> {{'SUM MIN' | translate}}</th>
                                </table>
                        </div>
                    </div>
                    <div ng-repeat="(key,value) in group track by $index">
                        <div class="row">
                            <div class="col-md-12">
                                <table class="table table-head-fixed table-hover" style="margin-bottom: 0px;">
                                    <td width="15%" ng-show="Step === 3 || Step === 5"> {{key}} </td>
                                    <td width="15%" ng-show="Step === 4"> {{Xlabel[$index] | translate}}</td>
                                    <td width="15%" ng-show="Step === 2"> {{key | date:'MMM d'}}</td>
                                    <td width="15%" ng-show="Step === 1"> {{key | date:'HH:mm'}}</td>
                                </table>
                                <table class="table table-head-fixed table-hover" style="margin-bottom: 0px;">
                                    <tbody>
                                        <tr ng-repeat="e in value | limitTo:limit track by $index" >
                                            <td width="10%"> </td>
                                            <td width="20%"> <a ui-sref="emEmployeeEdit( {'emID': e.emID })" ng-bind="e.emName"> </a></td>
                                            <td width="20%"> 
                                                <nobr>
                                                    <button class="btn btn-link btn-xs" style="cursor: default;">
                                                        <i class="fa fa-arrow-circle-up fa-lg"  ng-show="e.IsOut"    aria-hidden="true" uib-tooltip="{{e.IsOut | CallTypeFilters}}" style="color:grey;"></i>
                                                        <i class="fa fa-arrow-circle-down fa-lg"  ng-show="!e.IsOut"   aria-hidden="true" uib-tooltip="{{e.IsOut | CallTypeFilters}}" style="color:black;"></i>
                                                    </button>
                                                    <span ng-bind="(e.disposition|CallStatus).disposition" class="badge {{(e.disposition | CallStatus).color}}"></span>
                                                </nobr>
                                            </td>
                                            <td width="10%"><label ng-show="e.QtyCall > 0" uib-tooltip="{{'qtyCall' | translate }}" tooltip-placement="right" ng-bind="e.QtyCall" class="badge {{(e.disposition | CallStatus).color}}" style="float: initial;"></label></td>
                                            <td width="10%"><span ng-show="e.avgVoiceMin" ng-bind="e.avgVoiceMin" uib-tooltip="{{ 'ADTd' | translate}}"></span></td>
                                            <td width="10%"><span ng-show="e.avgBillMin" ng-bind="e.avgBillMin"  uib-tooltip="{{ 'ABTd' | translate}}"></span></td>
                                            <td width="10%"><span ng-show="e.avgWaitMin" ng-bind="e.avgWaitMin"  uib-tooltip="{{ 'AWTd' | translate}}"></span></td>
                                            <td width="10%"><span ng-show="e.qtyVoiceMin" ng-bind="e.qtyVoiceMin" uib-tooltip="{{ 'SUM MINd' | translate}}"></span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    
                </div>
            </div>
          </div>
        </div>
      </div>
</section>